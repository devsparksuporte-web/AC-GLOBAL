import{c as e,i as t,o as n,r}from"./index-C9yBzEdM.js";import{t as i}from"./ClientePortal-DLC5WvNi.js";var a=e(n(),1),o=r(),s=()=>(0,o.jsx)(`svg`,{width:`24`,height:`24`,viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,strokeWidth:`2`,strokeLinecap:`round`,strokeLinejoin:`round`,children:(0,o.jsx)(`polyline`,{points:`20 6 9 17 4 12`})});function c(){let[e,n]=(0,a.useState)(1),[r,c]=(0,a.useState)([]),[l,u]=(0,a.useState)([]),[d,f]=(0,a.useState)(!0),[p,m]=(0,a.useState)(!1),h=t(),[g,_]=(0,a.useState)({equipamento_id:``,servico_id:``,data_agendamento:``,observacoes:``});(0,a.useEffect)(()=>{(async()=>{try{let[e,t]=await Promise.all([i.getMeusEquipamentos(),i.listarServicosDisponiveis()]);c(e),u(t)}catch(e){console.error(e)}finally{f(!1)}})()},[]);let v=l.find(e=>e.id===g.servico_id);return d?(0,o.jsx)(`div`,{className:`client-loading`,children:`Buscando opções...`}):(0,o.jsxs)(`div`,{className:`agendamento-online`,children:[(0,o.jsxs)(`header`,{className:`ag-header`,children:[(0,o.jsx)(`h1`,{children:`Agendamento Rápido`}),(0,o.jsxs)(`div`,{className:`stepper horizontal-scroll hide-scrollbar`,children:[(0,o.jsx)(`div`,{className:`step-dot ${e>=1?`active`:``}`,children:`1`}),(0,o.jsx)(`div`,{className:`step-line`}),(0,o.jsx)(`div`,{className:`step-dot ${e>=2?`active`:``}`,children:`2`}),(0,o.jsx)(`div`,{className:`step-line`}),(0,o.jsx)(`div`,{className:`step-dot ${e>=3?`active`:``}`,children:`3`})]})]}),(0,o.jsxs)(`div`,{className:`ag-content`,children:[e===1&&(0,o.jsxs)(`div`,{className:`step-pane`,children:[(0,o.jsx)(`h2`,{children:`Onde será o serviço?`}),(0,o.jsx)(`div`,{className:`selection-grid`,children:r.length===0?(0,o.jsxs)(`div`,{className:`empty-wizard`,children:[(0,o.jsx)(`p`,{children:`Nenhum equipamento encontrado em seu perfil.`}),(0,o.jsx)(`p`,{className:`hint`,children:`Por favor, entre em contato com o suporte para vincular seus aparelhos ao seu cadastro.`}),(0,o.jsx)(`button`,{className:`btn-secondary`,onClick:()=>h(`/portal`),children:`Voltar ao Dashboard`})]}):r.map(e=>(0,o.jsxs)(`div`,{className:`select-card ${g.equipamento_id===e.id?`selected`:``}`,onClick:()=>{_({...g,equipamento_id:e.id}),n(2)},children:[(0,o.jsx)(`h3`,{children:e.nome}),(0,o.jsx)(`p`,{children:e.localizacao})]},e.id))})]}),e===2&&(0,o.jsxs)(`div`,{className:`step-pane`,children:[(0,o.jsx)(`h2`,{children:`Qual serviço você precisa?`}),(0,o.jsx)(`div`,{className:`selection-grid`,children:l.length===0?(0,o.jsxs)(`div`,{className:`empty-wizard`,children:[(0,o.jsx)(`p`,{children:`Não há serviços disponíveis para agendamento online no momento.`}),(0,o.jsx)(`button`,{className:`btn-secondary`,onClick:()=>n(1),children:`Voltar`})]}):l.map(e=>(0,o.jsxs)(`div`,{className:`select-card service ${g.servico_id===e.id?`selected`:``}`,onClick:()=>{_({...g,servico_id:e.id}),n(3)},children:[(0,o.jsxs)(`div`,{className:`sv-title`,children:[(0,o.jsx)(`h3`,{children:e.nome}),(0,o.jsxs)(`span`,{className:`price`,children:[`R$ `,e.preco_base.toFixed(2)]})]}),(0,o.jsx)(`p`,{children:e.descricao}),(0,o.jsxs)(`span`,{className:`time`,children:[`⏱️ ~`,e.tempo_estimado_minutos,` min`]})]},e.id))}),(0,o.jsx)(`button`,{className:`btn-secondary`,onClick:()=>n(1),children:`Voltar`})]}),e===3&&(0,o.jsxs)(`div`,{className:`step-pane`,children:[(0,o.jsx)(`h2`,{children:`Escolha uma data e finalize`}),(0,o.jsxs)(`div`,{className:`final-form`,children:[(0,o.jsxs)(`div`,{className:`form-group`,children:[(0,o.jsx)(`label`,{children:`Data sugerida`}),(0,o.jsx)(`input`,{type:`date`,className:`form-input`,min:new Date().toISOString().split(`T`)[0],value:g.data_agendamento,onChange:e=>_({...g,data_agendamento:e.target.value})})]}),(0,o.jsxs)(`div`,{className:`form-group`,children:[(0,o.jsx)(`label`,{children:`Observações Adicionais`}),(0,o.jsx)(`textarea`,{className:`form-input`,rows:3,placeholder:`Ex: Trazer escada longa, o portão está com barulho...`,value:g.observacoes,onChange:e=>_({...g,observacoes:e.target.value})})]}),(0,o.jsxs)(`div`,{className:`summary-quote`,children:[(0,o.jsx)(`h3`,{children:`Resumo do Pedido`}),(0,o.jsxs)(`div`,{className:`summary-row`,children:[(0,o.jsx)(`span`,{children:`Serviço:`}),(0,o.jsx)(`strong`,{children:v?.nome})]}),(0,o.jsxs)(`div`,{className:`summary-row total`,children:[(0,o.jsx)(`span`,{children:`Total (Estimado):`}),(0,o.jsxs)(`strong`,{children:[`R$ `,v?.preco_base.toFixed(2)]})]})]}),(0,o.jsxs)(`div`,{className:`final-actions`,children:[(0,o.jsx)(`button`,{className:`btn-secondary`,onClick:()=>n(2),children:`Voltar`}),(0,o.jsx)(`button`,{className:`btn-primary`,disabled:!g.data_agendamento||p,onClick:async()=>{m(!0);try{await i.agendarServico(g),n(4)}catch{alert(`Erro ao agendar. Tente novamente mais tarde.`)}finally{m(!1)}},children:p?`Agendando...`:`Confirmar Agendamento`})]})]})]}),e===4&&(0,o.jsxs)(`div`,{className:`success-pane`,children:[(0,o.jsx)(`div`,{className:`success-icon`,children:(0,o.jsx)(s,{})}),(0,o.jsx)(`h2`,{children:`Solicitação Enviada!`}),(0,o.jsx)(`p`,{children:`Seu agendamento foi encaminhado. Nossa equipe entrará em contato via WhatsApp para confirmar o horário exato.`}),(0,o.jsx)(`button`,{className:`btn-primary`,onClick:()=>h(`/portal`),children:`Ir para o Dashboard`})]})]})]})}export{c as default};