import{n as e}from"./index-C9yBzEdM.js";const t={async getMeusEquipamentos(){let{data:{user:t}}=await e.auth.getUser();if(!t)throw Error(`Cliente não autenticado`);let{data:n}=await e.from(`perfis`).select(`cliente_id`).eq(`id`,t.id).single();if(!n?.cliente_id)return[];let{data:r,error:i}=await e.from(`equipamentos`).select(`*`).eq(`cliente_id`,n.cliente_id).order(`nome`);if(i)throw i;return r||[]},async getHistoricoServicos(){let{data:{user:t}}=await e.auth.getUser();if(!t)throw Error(`Cliente não autenticado`);let{data:n,error:r}=await e.from(`ordens_servico`).select(`*, cliente:clientes(*)`).order(`created_at`,{ascending:!1});if(r)throw r;return n||[]},async listarServicosDisponiveis(){let{data:t,error:n}=await e.from(`servicos_precos`).select(`*`).eq(`ativo`,!0).order(`nome`);if(n)throw n;return t||[]},async agendarServico(t){let{data:{user:n}}=await e.auth.getUser();if(!n)throw Error(`Usuário não autenticado`);let{data:r}=await e.from(`perfis`).select(`cliente_id, empresa_id`).eq(`id`,n.id).single();if(!r?.cliente_id)throw Error(`Perfil de cliente não configurado corretamente`);let{data:i}=await e.from(`servicos_precos`).select(`*`).eq(`id`,t.servico_id).single(),{data:a}=await e.from(`equipamentos`).select(`nome`).eq(`id`,t.equipamento_id).single(),{data:o,error:s}=await e.from(`orcamentos`).insert([{empresa_id:r.empresa_id,cliente_id:r.cliente_id,descricao:`${i?.nome||`Serviço`} - ${a?.nome||`Equipamento`}`,equipamento:a?.nome,valor:i?.preco_base||0,data_inicio:t.data_agendamento,status:`pendente`,observacoes:t.observacoes}]).select().single();if(s)throw s;return o}};export{t};