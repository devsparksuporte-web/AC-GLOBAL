import{c as e,n as t,o as n,r,t as i}from"./index-C9yBzEdM.js";import{t as a}from"./transparentService-CwEGEg_3.js";var o=e(n(),1),s=r(),c=()=>(0,s.jsxs)(`svg`,{width:`20`,height:`20`,viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,strokeWidth:`2`,strokeLinecap:`round`,strokeLinejoin:`round`,children:[(0,s.jsx)(`path`,{d:`M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2`}),(0,s.jsx)(`circle`,{cx:`12`,cy:`7`,r:`4`})]}),l=()=>(0,s.jsxs)(`svg`,{width:`20`,height:`20`,viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,strokeWidth:`2`,strokeLinecap:`round`,strokeLinejoin:`round`,children:[(0,s.jsx)(`rect`,{x:`3`,y:`11`,width:`18`,height:`11`,rx:`2`,ry:`2`}),(0,s.jsx)(`path`,{d:`M7 11V7a5 5 0 0 1 10 0v4`})]}),u=()=>(0,s.jsxs)(`svg`,{width:`20`,height:`20`,viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,strokeWidth:`2`,strokeLinecap:`round`,strokeLinejoin:`round`,children:[(0,s.jsx)(`path`,{d:`M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9`}),(0,s.jsx)(`path`,{d:`M13.73 21a2 2 0 0 1-3.46 0`})]});function d(){let{user:e,userProfile:n}=i(),[r,d]=(0,o.useState)(`perfil`),[f,p]=(0,o.useState)(!1),[m,h]=(0,o.useState)(null),g=(0,o.useRef)(null);(0,o.useEffect)(()=>{if(g.current){let e=g.current.querySelector(`.nav-item.active`);e&&e.scrollIntoView({behavior:`smooth`,inline:`center`,block:`nearest`})}},[r]);let[_,v]=(0,o.useState)(n?.nome||``),[y,b]=(0,o.useState)(e?.user_metadata?.avatar_url||``),[x]=(0,o.useState)(n?.email||``),[S,C]=(0,o.useState)(n?.latitude?.toString()||``),[w,T]=(0,o.useState)(n?.longitude?.toString()||``),[E,D]=(0,o.useState)(``),[O,k]=(0,o.useState)(``),[A,j]=(0,o.useState)(!1),[M,N]=(0,o.useState)(!0);return(0,s.jsxs)(`div`,{className:`config-page`,children:[(0,s.jsx)(`div`,{className:`config-header`,children:(0,s.jsx)(`h1`,{className:`config-title`,children:`Configurações`})}),(0,s.jsxs)(`div`,{className:`config-container`,children:[(0,s.jsx)(`aside`,{className:`config-sidebar`,children:(0,s.jsxs)(`nav`,{className:`config-nav horizontal-tabs-container hide-scrollbar`,ref:g,children:[(0,s.jsxs)(`button`,{className:`nav-item ${r===`perfil`?`active`:``}`,onClick:()=>d(`perfil`),children:[(0,s.jsx)(c,{}),` Meu Perfil`]}),(0,s.jsxs)(`button`,{className:`nav-item ${r===`seguranca`?`active`:``}`,onClick:()=>d(`seguranca`),children:[(0,s.jsx)(l,{}),` Segurança`]}),(0,s.jsxs)(`button`,{className:`nav-item ${r===`preferencias`?`active`:``}`,onClick:()=>d(`preferencias`),children:[(0,s.jsx)(u,{}),` Preferências`]})]})}),(0,s.jsxs)(`main`,{className:`config-content`,children:[m&&(0,s.jsx)(`div`,{className:`message-banner ${m.type}`,style:{padding:`1rem`,borderRadius:`0.5rem`,marginBottom:`1rem`,backgroundColor:m.type===`success`?`#dcfce7`:`#fee2e2`,color:m.type===`success`?`#166534`:`#991b1b`,border:`1px solid ${m.type===`success`?`#bbf7d0`:`#fecaca`}`},children:m.text}),r===`perfil`&&(0,s.jsxs)(`div`,{className:`tab-content`,children:[(0,s.jsx)(`h2`,{className:`section-title`,children:`Meu Perfil`}),(0,s.jsxs)(`div`,{className:`profile-avatar-section`,children:[(0,s.jsx)(`div`,{className:`avatar-preview`,children:y?(0,s.jsx)(`img`,{src:y,alt:`Avatar`,style:{width:`100%`,height:`100%`,borderRadius:`50%`,objectFit:`cover`}}):_?_.charAt(0).toUpperCase():(0,s.jsx)(c,{})}),(0,s.jsxs)(`div`,{className:`avatar-actions`,children:[(0,s.jsxs)(`div`,{className:`upload-btn-wrapper`,style:{position:`relative`,overflow:`hidden`},children:[(0,s.jsx)(`button`,{className:`btn-secondary`,disabled:f,children:f?`Subindo...`:`Alterar Foto`}),(0,s.jsx)(`input`,{type:`file`,accept:`image/*`,style:{position:`absolute`,opacity:0,inset:0,cursor:`pointer`},onChange:async e=>{if(e.target.files?.[0]){p(!0),h(null);try{b(await a.uploadAvatar(e.target.files[0])),h({type:`success`,text:`Foto de perfil atualizada!`})}catch(e){console.error(`Erro no upload do avatar:`,e),h({type:`error`,text:`Erro ao fazer upload da foto.`})}finally{p(!1)}}},disabled:f})]}),(0,s.jsx)(`span`,{style:{fontSize:`0.8rem`,color:`#666`},children:`JPG ou PNG. Max 1MB.`})]})]}),(0,s.jsxs)(`form`,{onSubmit:async n=>{n.preventDefault(),p(!0),h(null);try{let{error:n}=await t.from(`perfis`).update({nome:_,latitude:S?parseFloat(S):null,longitude:w?parseFloat(w):null}).eq(`id`,e?.id);if(n)throw n;h({type:`success`,text:`Perfil atualizado com sucesso!`})}catch{h({type:`error`,text:`Erro ao atualizar perfil.`})}finally{p(!1)}},children:[(0,s.jsxs)(`div`,{className:`form-section`,children:[(0,s.jsxs)(`div`,{className:`form-group`,children:[(0,s.jsx)(`label`,{className:`form-label`,children:`Nome Completo`}),(0,s.jsx)(`input`,{type:`text`,className:`form-input`,value:_,onChange:e=>v(e.target.value)})]}),(0,s.jsxs)(`div`,{className:`form-group`,children:[(0,s.jsx)(`label`,{className:`form-label`,children:`Email`}),(0,s.jsx)(`input`,{type:`email`,className:`form-input`,value:x,disabled:!0,style:{background:`#f3f4f6`,cursor:`not-allowed`}})]})]}),(0,s.jsxs)(`div`,{className:`form-section`,children:[(0,s.jsx)(`h3`,{style:{fontSize:`1rem`,fontWeight:600,marginBottom:`1rem`,marginTop:`1.5rem`},children:`Localização`}),(0,s.jsxs)(`div`,{className:`form-row`,style:{display:`grid`,gridTemplateColumns:`1fr 1fr`,gap:`1rem`,marginBottom:`1rem`},children:[(0,s.jsxs)(`div`,{className:`form-group`,children:[(0,s.jsx)(`label`,{className:`form-label`,children:`Latitude`}),(0,s.jsx)(`input`,{type:`number`,step:`any`,className:`form-input`,value:S,onChange:e=>C(e.target.value),placeholder:`-23.5505`})]}),(0,s.jsxs)(`div`,{className:`form-group`,children:[(0,s.jsx)(`label`,{className:`form-label`,children:`Longitude`}),(0,s.jsx)(`input`,{type:`number`,step:`any`,className:`form-input`,value:w,onChange:e=>T(e.target.value),placeholder:`-46.6333`})]})]}),(0,s.jsx)(`p`,{style:{fontSize:`0.75rem`,color:`#666`,marginTop:`-0.5rem`,marginBottom:`1.5rem`},children:`Coordenadas usadas para as previsões climáticas e alertas de onda de calor.`})]}),(0,s.jsx)(`button`,{type:`submit`,className:`btn-primary`,disabled:f,children:f?`Salvando...`:`Salvar Alterações`})]})]}),r===`seguranca`&&(0,s.jsxs)(`div`,{className:`tab-content`,children:[(0,s.jsx)(`h2`,{className:`section-title`,children:`Segurança`}),(0,s.jsxs)(`form`,{onSubmit:async e=>{if(e.preventDefault(),E!==O){h({type:`error`,text:`As senhas não conferem.`});return}p(!0),h(null);try{let{error:e}=await t.auth.updateUser({password:E});if(e)throw e;h({type:`success`,text:`Senha alterada com sucesso!`}),D(``),k(``)}catch{h({type:`error`,text:`Erro ao alterar senha.`})}finally{p(!1)}},children:[(0,s.jsxs)(`div`,{className:`form-section`,children:[(0,s.jsxs)(`div`,{className:`form-group`,children:[(0,s.jsx)(`label`,{className:`form-label`,children:`Nova Senha`}),(0,s.jsx)(`input`,{type:`password`,className:`form-input`,value:E,onChange:e=>D(e.target.value),placeholder:`Mínimo 6 caracteres`})]}),(0,s.jsxs)(`div`,{className:`form-group`,children:[(0,s.jsx)(`label`,{className:`form-label`,children:`Confirmar Nova Senha`}),(0,s.jsx)(`input`,{type:`password`,className:`form-input`,value:O,onChange:e=>k(e.target.value),placeholder:`Confirme sua nova senha`})]})]}),(0,s.jsx)(`button`,{type:`submit`,className:`btn-primary`,disabled:f||!E,children:f?`Alterando...`:`Alterar Senha`})]})]}),r===`preferencias`&&(0,s.jsxs)(`div`,{className:`tab-content`,children:[(0,s.jsx)(`h2`,{className:`section-title`,children:`Preferências do Sistema`}),(0,s.jsxs)(`div`,{className:`settings-list`,children:[(0,s.jsxs)(`div`,{className:`setting-item`,children:[(0,s.jsxs)(`div`,{className:`setting-info`,children:[(0,s.jsx)(`div`,{className:`setting-title`,children:`Modo Escuro`}),(0,s.jsx)(`div`,{className:`setting-description`,children:`Alternar entre tema claro e escuro`})]}),(0,s.jsx)(`div`,{className:`toggle-switch ${A?`active`:``}`,onClick:()=>j(!A),children:(0,s.jsx)(`div`,{className:`toggle-thumb`})})]}),(0,s.jsxs)(`div`,{className:`setting-item`,children:[(0,s.jsxs)(`div`,{className:`setting-info`,children:[(0,s.jsx)(`div`,{className:`setting-title`,children:`Notificações por Email`}),(0,s.jsx)(`div`,{className:`setting-description`,children:`Receber atualizações sobre ordens de serviço`})]}),(0,s.jsx)(`div`,{className:`toggle-switch ${M?`active`:``}`,onClick:()=>N(!M),children:(0,s.jsx)(`div`,{className:`toggle-thumb`})})]})]})]})]})]})]})}export{d as ConfiguracoesPage,d as default};