import{c as e,i as t,o as n,r,t as i}from"./index-C9yBzEdM.js";import{t as a}from"./adminService-DRZDLqYL.js";import"./conformidadeService-DTfsGcFE.js";import{t as o}from"./ordensService-CQbPUMAW.js";import{t as s}from"./clientesService-BnZzC_Tg.js";var c=e(n(),1),l=r(),u=()=>(0,l.jsxs)(`svg`,{width:`24`,height:`24`,viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,strokeWidth:`2`,strokeLinecap:`round`,strokeLinejoin:`round`,children:[(0,l.jsx)(`rect`,{x:`4`,y:`2`,width:`16`,height:`20`,rx:`2`,ry:`2`}),(0,l.jsx)(`line`,{x1:`9`,y1:`22`,x2:`9`,y2:`22.01`}),(0,l.jsx)(`line`,{x1:`15`,y1:`22`,x2:`15`,y2:`22.01`}),(0,l.jsx)(`line`,{x1:`12`,y1:`22`,x2:`12`,y2:`22.01`}),(0,l.jsx)(`line`,{x1:`12`,y1:`2`,x2:`12`,y2:`22`})]}),d=()=>(0,l.jsxs)(`svg`,{width:`24`,height:`24`,viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,strokeWidth:`2`,strokeLinecap:`round`,strokeLinejoin:`round`,children:[(0,l.jsx)(`path`,{d:`M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2`}),(0,l.jsx)(`circle`,{cx:`9`,cy:`7`,r:`4`}),(0,l.jsx)(`path`,{d:`M23 21v-2a4 4 0 0 0-3-3.87`}),(0,l.jsx)(`path`,{d:`M16 3.13a4 4 0 0 1 0 7.75`})]}),f=()=>(0,l.jsx)(`svg`,{width:`24`,height:`24`,viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,strokeWidth:`2`,strokeLinecap:`round`,strokeLinejoin:`round`,children:(0,l.jsx)(`path`,{d:`M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z`})}),p=()=>(0,l.jsxs)(`svg`,{width:`24`,height:`24`,viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,strokeWidth:`2`,strokeLinecap:`round`,strokeLinejoin:`round`,children:[(0,l.jsx)(`circle`,{cx:`12`,cy:`12`,r:`10`}),(0,l.jsx)(`line`,{x1:`12`,y1:`8`,x2:`12`,y2:`12`}),(0,l.jsx)(`line`,{x1:`12`,y1:`16`,x2:`12.01`,y2:`16`})]}),m=()=>(0,l.jsxs)(`svg`,{width:`20`,height:`20`,viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,strokeWidth:`2`,strokeLinecap:`round`,strokeLinejoin:`round`,children:[(0,l.jsx)(`line`,{x1:`12`,y1:`5`,x2:`12`,y2:`19`}),(0,l.jsx)(`line`,{x1:`5`,y1:`12`,x2:`19`,y2:`12`})]}),h=()=>(0,l.jsx)(`svg`,{width:`20`,height:`20`,viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,strokeWidth:`2`,strokeLinecap:`round`,strokeLinejoin:`round`,children:(0,l.jsx)(`polyline`,{points:`9 18 15 12 9 6`})});function g(){let e=t(),{isSuperAdmin:n,userProfile:r}=i(),[g,_]=(0,c.useState)({totalEmpresas:0,totalUsuarios:0,totalClientes:0,ordensAbertas:0,ordensEmAndamento:0,ordensConcluidas:0,ordensCanceladas:0}),[v,y]=(0,c.useState)([]),[b,x]=(0,c.useState)(!0);(0,c.useEffect)(()=>{r?.role===`cliente`&&e(`/portal`)},[r,e]),(0,c.useEffect)(()=>{(async()=>{try{let e=await o.estatisticas(),t=await o.listarRecentes(5),r=await s.contar(),i=0,c=0;if(n){let e=await a.listarEmpresas(),t=await a.listarUsuarios();i=e.length,c=t.length}_({totalEmpresas:i,totalUsuarios:c,totalClientes:r,ordensAbertas:e.abertas,ordensEmAndamento:e.emAndamento,ordensConcluidas:e.concluidas,ordensCanceladas:e.canceladas}),y(t)}catch(e){console.error(`Erro ao carregar dashboard:`,e)}finally{x(!1)}})()},[n]);let S=g.ordensAbertas+g.ordensEmAndamento+g.ordensConcluidas+g.ordensCanceladas,C=e=>S>0?e/S*100:0,w=S>0?`conic-gradient(
            #3b82f6 0% ${C(g.ordensEmAndamento)}%,
            #fbbf24 ${C(g.ordensEmAndamento)}% ${C(g.ordensEmAndamento)+C(g.ordensAbertas)}%,
            #10b981 ${C(g.ordensEmAndamento)+C(g.ordensAbertas)}% ${C(g.ordensEmAndamento)+C(g.ordensAbertas)+C(g.ordensConcluidas)}%,
            #ef4444 ${C(g.ordensEmAndamento)+C(g.ordensAbertas)+C(g.ordensConcluidas)}% 100%
        )`:`conic-gradient(#e2e8f0 0% 100%)`;return(0,l.jsxs)(`div`,{className:`dashboard-container`,children:[(0,l.jsxs)(`div`,{className:`dashboard-header`,children:[(0,l.jsxs)(`div`,{children:[(0,l.jsx)(`h1`,{className:`dashboard-title`,children:`Dashboard`}),(0,l.jsxs)(`p`,{className:`dashboard-subtitle`,children:[`Visão geral • `,r?.empresa?.nome||`Sistema`]})]}),(0,l.jsx)(`div`,{className:`header-actions`,children:(0,l.jsxs)(`button`,{className:`btn-primary`,onClick:()=>e(`/ordens`),children:[(0,l.jsx)(m,{}),` Chamado`]})})]}),(0,l.jsxs)(`div`,{className:`summary-cards horizontal-scroll hide-scrollbar`,children:[n&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(`div`,{className:`summary-card`,children:[(0,l.jsx)(`div`,{className:`card-icon blue`,children:(0,l.jsx)(u,{})}),(0,l.jsxs)(`div`,{className:`card-info`,children:[(0,l.jsx)(`span`,{className:`card-value`,children:b?`-`:g.totalEmpresas}),(0,l.jsx)(`span`,{className:`card-label`,children:`Empresas Ativas`})]})]}),(0,l.jsxs)(`div`,{className:`summary-card`,children:[(0,l.jsx)(`div`,{className:`card-icon indigo`,children:(0,l.jsx)(d,{})}),(0,l.jsxs)(`div`,{className:`card-info`,children:[(0,l.jsx)(`span`,{className:`card-value`,children:b?`-`:g.totalUsuarios}),(0,l.jsx)(`span`,{className:`card-label`,children:`Usuários Cadastrados`})]})]})]}),(0,l.jsxs)(`div`,{className:`summary-card`,children:[(0,l.jsx)(`div`,{className:`card-icon blue-light`,children:(0,l.jsx)(f,{})}),(0,l.jsxs)(`div`,{className:`card-info`,children:[(0,l.jsx)(`span`,{className:`card-value`,children:`__`}),(0,l.jsx)(`span`,{className:`card-label`,children:`Equipamentos`})]})]}),(0,l.jsxs)(`div`,{className:`summary-card`,children:[(0,l.jsx)(`div`,{className:`card-icon red-light`,children:(0,l.jsx)(p,{})}),(0,l.jsxs)(`div`,{className:`card-info`,children:[(0,l.jsx)(`span`,{className:`card-value`,children:b?`-`:g.ordensAbertas}),(0,l.jsx)(`span`,{className:`card-label`,children:`Ordens Pendentes`})]})]})]}),(0,l.jsxs)(`div`,{className:`dashboard-grid`,children:[(0,l.jsxs)(`div`,{className:`dashboard-section chart-section`,children:[(0,l.jsxs)(`div`,{className:`section-header`,children:[(0,l.jsx)(`h3`,{children:`Status das OS`}),(0,l.jsx)(`button`,{className:`btn-icon-small`,children:(0,l.jsx)(m,{})})]}),(0,l.jsxs)(`div`,{className:`chart-container`,children:[(0,l.jsx)(`div`,{className:`donut-chart`,style:{background:w},children:(0,l.jsx)(`div`,{className:`donut-hole`,children:(0,l.jsx)(`span`,{className:`chart-total`,children:S})})}),(0,l.jsxs)(`div`,{className:`chart-legend`,children:[(0,l.jsxs)(`div`,{className:`legend-item`,children:[(0,l.jsx)(`span`,{className:`dot blue`}),(0,l.jsx)(`span`,{className:`label`,children:`Em andamento`}),(0,l.jsxs)(`span`,{className:`value`,children:[C(g.ordensEmAndamento).toFixed(0),`%`]})]}),(0,l.jsxs)(`div`,{className:`legend-item`,children:[(0,l.jsx)(`span`,{className:`dot yellow`}),(0,l.jsx)(`span`,{className:`label`,children:`Pendente`}),(0,l.jsxs)(`span`,{className:`value`,children:[C(g.ordensAbertas).toFixed(0),`%`]})]}),(0,l.jsxs)(`div`,{className:`legend-item`,children:[(0,l.jsx)(`span`,{className:`dot green`}),(0,l.jsx)(`span`,{className:`label`,children:`Concluída`}),(0,l.jsxs)(`span`,{className:`value`,children:[C(g.ordensConcluidas).toFixed(0),`%`]})]}),(0,l.jsxs)(`div`,{className:`legend-item`,children:[(0,l.jsx)(`span`,{className:`dot red`}),(0,l.jsx)(`span`,{className:`label`,children:`Cancelada`}),(0,l.jsxs)(`span`,{className:`value`,children:[C(g.ordensCanceladas).toFixed(0),`%`]})]})]})]})]}),(0,l.jsxs)(`div`,{className:`dashboard-section activity-section`,children:[(0,l.jsxs)(`div`,{className:`section-header`,children:[(0,l.jsx)(`h3`,{children:r?.role===`tecnico`?`Minhas Ordens de Serviço`:`Chamados recentes`}),(0,l.jsxs)(`button`,{className:`btn-link`,onClick:()=>e(`/ordens`),children:[`Ver todos `,(0,l.jsx)(h,{})]})]}),(0,l.jsx)(`div`,{className:`activity-list`,children:b?(0,l.jsx)(`p`,{className:`loading-text`,children:`Carregando...`}):v.length===0?(0,l.jsx)(`p`,{className:`empty-text`,children:`Nenhum chamado recente.`}):r?.role===`tecnico`?(0,l.jsx)(`div`,{className:`tec-orders-list`,children:v.map(e=>(0,l.jsxs)(`div`,{className:`activity-item tec-order-item`,children:[(0,l.jsxs)(`div`,{className:`activity-info`,children:[(0,l.jsx)(`span`,{className:`activity-title`,children:e.descricao||`Chamado #${e.numero}`}),(0,l.jsxs)(`span`,{className:`activity-subtitle`,children:[(0,l.jsx)(`strong`,{children:`Destino:`}),` `,e.cliente?.nome,e.cliente?.cidade?` • ${e.cliente.cidade}`:``,e.cliente?.endereco?` (${e.cliente.endereco})`:``]}),(0,l.jsx)(`span`,{className:`activity-date`,children:new Date(e.created_at).toLocaleDateString()})]}),(0,l.jsx)(`div`,{className:`activity-badge-container`,children:(0,l.jsx)(`span`,{className:`status-badge ${e.status}`,children:e.status.replace(`_`,` `)})})]},e.id))}):v.map(e=>(0,l.jsxs)(`div`,{className:`activity-item`,children:[(0,l.jsxs)(`div`,{className:`activity-info`,children:[(0,l.jsx)(`span`,{className:`activity-title`,children:e.descricao||`Chamado #${e.numero}`}),(0,l.jsxs)(`span`,{className:`activity-subtitle`,children:[e.cliente?.nome,` • `,new Date(e.created_at).toLocaleDateString()]})]}),(0,l.jsx)(`span`,{className:`status-badge ${e.status}`,children:e.status.replace(`_`,` `)})]},e.id))})]})]})]})}export{g as DashboardHome,g as default};