import{c as e,o as t,r as n}from"./index-C9yBzEdM.js";/* empty css                 */import{t as r}from"./estoqueService-7b9QeiRZ.js";var i=e(t(),1),a=n();function o(){let[e,t]=(0,i.useState)([]),[n,o]=(0,i.useState)(!0),[s,c]=(0,i.useState)(!1),[l,u]=(0,i.useState)(null),[d,f]=(0,i.useState)(null),[p,m]=(0,i.useState)(0),[h,g]=(0,i.useState)(`entrada`),_=async()=>{try{o(!0),t(await r.listar())}catch(e){console.error(`Erro ao carregar estoque:`,e)}finally{o(!1)}};return(0,i.useEffect)(()=>{_()},[]),(0,a.jsxs)(`div`,{className:`estoque-page`,children:[(0,a.jsxs)(`div`,{className:`page-header`,children:[(0,a.jsx)(`h1`,{className:`page-title`,children:`Controle de Estoque`}),(0,a.jsx)(`button`,{className:`btn-primary`,onClick:()=>{u({}),c(!0)},children:`+ Novo Item`})]}),n?(0,a.jsx)(`div`,{className:`loading`,children:`Carregando estoque...`}):(0,a.jsx)(`div`,{className:`estoque-grid`,children:e.map(e=>(0,a.jsxs)(`div`,{className:`estoque-card ${e.quantidade<=e.quantidade_minima?`low-stock`:``}`,children:[(0,a.jsxs)(`div`,{className:`item-info`,children:[(0,a.jsx)(`h3`,{children:e.nome}),(0,a.jsx)(`p`,{children:e.descricao||`Sem descrição`}),(0,a.jsxs)(`div`,{className:`item-stats`,children:[(0,a.jsxs)(`div`,{className:`stat`,children:[(0,a.jsx)(`span`,{className:`label`,children:`Custo`}),(0,a.jsxs)(`span`,{className:`value`,children:[`R$ `,e.preco_unitario.toFixed(2)]})]}),(0,a.jsxs)(`div`,{className:`stat`,children:[(0,a.jsx)(`span`,{className:`label`,children:`Venda`}),(0,a.jsxs)(`span`,{className:`value`,style:{color:`#2563eb`},children:[`R$ `,(e.preco_venda||0).toFixed(2)]})]})]}),(0,a.jsxs)(`div`,{className:`item-stats`,style:{marginTop:`0.5rem`,borderTop:`1px dashed #eee`,paddingTop:`0.5rem`},children:[(0,a.jsxs)(`div`,{className:`stat`,children:[(0,a.jsx)(`span`,{className:`label`,children:`Qtd Total`}),(0,a.jsxs)(`span`,{className:`value`,children:[e.quantidade,` `,e.unidade]})]}),(0,a.jsxs)(`div`,{className:`stat`,children:[(0,a.jsx)(`span`,{className:`label`,children:`Qtd Mínima`}),(0,a.jsxs)(`span`,{className:`value`,style:{color:e.quantidade<=e.quantidade_minima?`#ef4444`:`inherit`},children:[e.quantidade_minima,` `,e.unidade]})]})]})]}),(0,a.jsxs)(`div`,{className:`item-actions`,children:[(0,a.jsx)(`button`,{className:`btn-secondary btn-sm`,onClick:()=>f(e),children:`Movimentar`}),(0,a.jsx)(`button`,{className:`btn-icon`,onClick:()=>{u(e),c(!0)},children:`✏️`})]})]},e.id))}),s&&(0,a.jsx)(`div`,{className:`modal-overlay`,children:(0,a.jsxs)(`div`,{className:`modal-content`,children:[(0,a.jsxs)(`div`,{className:`modal-header`,children:[(0,a.jsx)(`h2`,{className:`modal-title`,children:l?.id?`Editar Item`:`Novo Item`}),(0,a.jsx)(`button`,{className:`modal-close`,onClick:()=>c(!1),children:(0,a.jsx)(`span`,{style:{fontSize:`1.5rem`},children:`×`})})]}),(0,a.jsxs)(`form`,{onSubmit:async e=>{if(e.preventDefault(),l?.nome)try{l.id?await r.atualizar(l.id,l):await r.criar(l),c(!1),_()}catch(e){console.error(`Erro detalhado ao salvar:`,e),alert(`Erro ao salvar item: ${e.message||`Erro desconhecido`}`)}},children:[(0,a.jsxs)(`div`,{className:`modal-body`,children:[(0,a.jsxs)(`div`,{className:`form-group`,children:[(0,a.jsx)(`label`,{className:`form-label`,children:`Nome do Item`}),(0,a.jsx)(`input`,{type:`text`,className:`form-input`,value:l?.nome||``,onChange:e=>u({...l,nome:e.target.value}),required:!0})]}),(0,a.jsxs)(`div`,{className:`form-row`,children:[(0,a.jsxs)(`div`,{className:`form-group`,children:[(0,a.jsx)(`label`,{className:`form-label`,children:`Unidade`}),(0,a.jsx)(`input`,{type:`text`,className:`form-input`,value:l?.unidade||`un`,onChange:e=>u({...l,unidade:e.target.value})})]}),(0,a.jsxs)(`div`,{className:`form-group`,children:[(0,a.jsx)(`label`,{className:`form-label`,children:`Estoque Mínimo`}),(0,a.jsx)(`input`,{type:`number`,className:`form-input`,value:l?.quantidade_minima||0,onChange:e=>u({...l,quantidade_minima:Number(e.target.value)})})]})]}),(0,a.jsxs)(`div`,{className:`form-row`,children:[(0,a.jsxs)(`div`,{className:`form-group`,children:[(0,a.jsx)(`label`,{className:`form-label`,children:`Preço de Custo (Unit.)`}),(0,a.jsx)(`input`,{type:`number`,className:`form-input`,step:`0.01`,value:l?.preco_unitario||0,onChange:e=>u({...l,preco_unitario:Number(e.target.value)})})]}),(0,a.jsxs)(`div`,{className:`form-group`,children:[(0,a.jsx)(`label`,{className:`form-label`,children:`Preço de Venda`}),(0,a.jsx)(`input`,{type:`number`,className:`form-input`,step:`0.01`,value:l?.preco_venda||0,onChange:e=>u({...l,preco_venda:Number(e.target.value)})})]})]}),(0,a.jsxs)(`div`,{className:`form-group`,children:[(0,a.jsx)(`label`,{className:`form-label`,children:`Descrição`}),(0,a.jsx)(`textarea`,{className:`form-input`,value:l?.descricao||``,onChange:e=>u({...l,descricao:e.target.value})})]})]}),(0,a.jsxs)(`div`,{className:`modal-footer`,children:[(0,a.jsx)(`button`,{type:`button`,className:`btn-secondary`,onClick:()=>c(!1),children:`Cancelar`}),(0,a.jsx)(`button`,{type:`submit`,className:`btn-primary`,children:`Salvar`})]})]})]})}),d&&(0,a.jsx)(`div`,{className:`modal-overlay`,children:(0,a.jsxs)(`div`,{className:`modal-content`,style:{maxWidth:`400px`},children:[(0,a.jsxs)(`div`,{className:`modal-header`,children:[(0,a.jsx)(`h2`,{className:`modal-title`,children:`Movimentar Estoque`}),(0,a.jsx)(`button`,{className:`modal-close`,onClick:()=>f(null),children:(0,a.jsx)(`span`,{style:{fontSize:`1.5rem`},children:`×`})})]}),(0,a.jsxs)(`div`,{className:`modal-body`,children:[(0,a.jsxs)(`p`,{children:[(0,a.jsx)(`strong`,{children:`Item:`}),` `,d.nome]}),(0,a.jsxs)(`p`,{children:[(0,a.jsx)(`strong`,{children:`Saldo Atual:`}),` `,d.quantidade,` `,d.unidade]}),(0,a.jsxs)(`div`,{className:`form-group`,style:{marginTop:`1.5rem`},children:[(0,a.jsx)(`label`,{className:`form-label`,children:`Tipo de Movimentação`}),(0,a.jsxs)(`div`,{className:`tipo-switch`,children:[(0,a.jsx)(`button`,{type:`button`,className:h===`entrada`?`active`:``,onClick:()=>g(`entrada`),children:`Entrada`}),(0,a.jsx)(`button`,{type:`button`,className:h===`saida`?`active`:``,onClick:()=>g(`saida`),children:`Saída`})]})]}),(0,a.jsxs)(`div`,{className:`form-group`,children:[(0,a.jsx)(`label`,{className:`form-label`,children:`Quantidade`}),(0,a.jsx)(`input`,{type:`number`,className:`form-input`,value:p,onChange:e=>m(Number(e.target.value)),min:`0.01`,step:`0.01`})]})]}),(0,a.jsxs)(`div`,{className:`modal-footer`,children:[(0,a.jsx)(`button`,{className:`btn-secondary`,onClick:()=>f(null),children:`Cancelar`}),(0,a.jsx)(`button`,{className:`btn-primary`,onClick:async()=>{if(!(!d||p<=0))try{await r.registrarMovimentacao({item_id:d.id,tipo:h,quantidade:p,motivo:h===`entrada`?`Entrada Manual`:`Saída Manual`}),f(null),m(0),_()}catch(e){console.error(`Erro detalhado na movimentação:`,e),alert(`Erro ao registrar movimentação: ${e.message||`Erro desconhecido`}`)}},children:`Confirmar`})]})]})})]})}export{o as default};