import{n as e}from"./index-C9yBzEdM.js";const t={async listar(){let{data:t,error:n}=await e.from(`clientes`).select(`*`).eq(`ativo`,!0).order(`nome`);if(n)throw n;return t||[]},async buscarPorId(t){let{data:n,error:r}=await e.from(`clientes`).select(`*`).eq(`id`,t).single();if(r)throw r;return n},async criar(t){let{data:{user:n}}=await e.auth.getUser();if(!n)throw Error(`Usuário não autenticado`);let{data:r}=await e.from(`perfis`).select(`empresa_id, role`).eq(`id`,n.id).single();if(!r)throw Error(`Perfil não encontrado`);let i=r.empresa_id;if(r.role===`super_admin`&&t.empresa_id&&(i=t.empresa_id),!i)throw Error(`Empresa não definida para o cadastro`);let{empresa_id:a,...o}=t,{data:s,error:c}=await e.from(`clientes`).insert([{...o,empresa_id:i}]).select().single();if(c)throw c;return s},async atualizar(t,n){let{data:r,error:i}=await e.from(`clientes`).update(n).eq(`id`,t).select().single();if(i)throw i;return r},async excluir(t){let{error:n}=await e.from(`clientes`).update({ativo:!1}).eq(`id`,t);if(n)throw n},async buscar(t){let{data:n,error:r}=await e.from(`clientes`).select(`*`).eq(`ativo`,!0).or(`nome.ilike.%${t}%,telefone.ilike.%${t}%,email.ilike.%${t}%`).order(`nome`);if(r)throw r;return n||[]},async contar(){let{count:t,error:n}=await e.from(`clientes`).select(`*`,{count:`exact`,head:!0}).eq(`ativo`,!0);if(n)throw n;return t||0}};export{t};